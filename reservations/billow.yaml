name: bikesharing/reservations
dependencies:
  billing: bikesharing/billing
  bikes: bikesharing/bikes
  notifications: bikesharing/notifications
  redis: ./cache
components:
  type: container-group
  containers:
    api:
      environment:
        variables:
          BILLING_ENDPOINT: $(billing.endpoint)
          BIKES_ENDPOINT: $(bikes.endpoint)
          NOTIFICATIONS_ENDPOINT: $(notifications.endpoint)
          REDIS_CONNECTION_STRING: $(redis.connectionString)
    worker:
      build:
        context: worker
      environment:
        variables:
          BILLING_ENDPOINT: $(billing.endpoint)
          REDIS_CONNECTION_STRING: $(redis.connectionString)
exports:
  endpoint: $(api.endpoint)