name: bikesharing/reservations
components:
  api:
    dependencies:
      db:
        type: ./db
        requirements:
          roles: [reader]
    group: default
    environment:
      POSTGRES_CONNECTION_STRING: $(db.connectionString)
  engine:
    dependencies:
      billing: bikesharing/billing
      bikes: bikesharing/bikes
      notifications: bikesharing/notifications
      db:
        type: ./db
        roles: [reader, writer]
    source: engine
    group: default
    environment:
      BILLING_ENDPOINT: $(billing.endpoint)
      BIKES_ENDPOINT: $(bikes.endpoint)
      NOTIFICATIONS_ENDPOINT: $(notifications.endpoint)
      POSTGRES_CONNECTION_STRING: $(db.connectionString)
exports: api